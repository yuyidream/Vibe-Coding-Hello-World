# 华为云ECS网站部署完整操作指南

本指南将详细指导您如何将Hello World网站部署到华为云ECS服务器。

## 📋 部署流程概览

```
1. 配置华为云安全组 → 2. 连接到ECS服务器 → 3. 上传文件 → 4. 运行部署脚本 → 5. 访问网站
```

---

## 第一步：配置华为云安全组

请参考 `华为云安全组配置指南.md` 文件完成安全组配置。

**重要信息记录：**
- 您的ECS公网IP：________________
- SSH登录用户名：root
- SSH登录密码：________________

---

## 第二步：准备本地文件

在您的电脑上准备需要上传的文件：

1. **必需文件**：
   - `index.html` - 网站页面
   - `deploy.sh` - 自动部署脚本

2. **可选文件**：
   - `nginx-site.conf` - Nginx配置参考

---

## 第三步：连接到ECS服务器

### 方法一：使用Windows PowerShell（推荐）

1. 打开PowerShell（Win+X，选择"Windows PowerShell"）

2. 输入以下命令连接服务器：
   ```powershell
   ssh root@你的公网IP
   ```

3. 首次连接会提示确认，输入 `yes` 并回车

4. 输入密码（密码输入时不会显示，直接输入完按回车）

### 方法二：使用PuTTY

1. 下载并安装PuTTY：https://www.putty.org/

2. 打开PuTTY
   - Host Name：输入您的公网IP
   - Port：22
   - Connection type：SSH

3. 点击"Open"连接

4. 输入用户名 `root` 和密码

---

## 第四步：上传文件到服务器

### 方法A：使用SCP命令（推荐）

在**本地电脑**的PowerShell中执行（不是服务器上）：

```powershell
# 进入项目目录
cd "C:\编程工具\cursor的项目\Vibe-Coding-Hello-World"

# 上传index.html
scp index.html root@你的公网IP:/root/

# 上传部署脚本
scp deploy.sh root@你的公网IP:/root/
```

### 方法B：使用WinSCP（图形化工具）

1. 下载并安装WinSCP：https://winscp.net/

2. 打开WinSCP，创建新连接：
   - 文件协议：SCP
   - 主机名：您的公网IP
   - 端口号：22
   - 用户名：root
   - 密码：您的密码

3. 点击"登录"

4. 将本地的 `index.html` 和 `deploy.sh` 拖拽到右侧（服务器的 `/root` 目录）

---

## 第五步：运行部署脚本

在**服务器SSH终端**中执行：

```bash
# 1. 确认文件已上传
ls -lh

# 2. 给部署脚本添加执行权限
chmod +x deploy.sh

# 3. 运行部署脚本
bash deploy.sh
```

脚本会自动完成以下操作：
- ✅ 更新系统包
- ✅ 安装Nginx
- ✅ 配置网站目录
- ✅ 配置Nginx
- ✅ 启动Nginx服务

**预计耗时**：2-5分钟

---

## 第六步：验证部署

### 1. 检查Nginx服务状态

```bash
systemctl status nginx
```

看到 `active (running)` 表示服务正常运行。

### 2. 浏览器访问

打开浏览器，访问：
```
http://你的公网IP
```

您应该能看到Hello World页面！

---

## 🔧 常用管理命令

```bash
# 查看Nginx状态
systemctl status nginx

# 重启Nginx
systemctl restart nginx

# 停止Nginx
systemctl stop nginx

# 启动Nginx
systemctl start nginx

# 重新加载配置（不中断服务）
systemctl reload nginx

# 查看访问日志
tail -f /var/log/nginx/hello-world-access.log

# 查看错误日志
tail -f /var/log/nginx/hello-world-error.log

# 测试Nginx配置文件
nginx -t
```

---

## 📝 更新网站内容

如果您修改了 `index.html`，只需：

1. 用SCP上传新的 `index.html` 到服务器：
   ```powershell
   scp index.html root@你的公网IP:/var/www/hello-world/
   ```

2. 刷新浏览器即可看到更新

不需要重启Nginx！

---

## 🛠️ 故障排查

### 问题1：无法SSH连接

**症状**：连接超时或拒绝连接

**解决方案**：
- 检查安全组是否开放22端口
- 确认公网IP地址正确
- 检查ECS实例是否正在运行

### 问题2：浏览器无法访问

**症状**：访问 http://公网IP 超时或无法访问

**解决方案**：
- 检查安全组是否开放80端口
- 在服务器上检查Nginx状态：`systemctl status nginx`
- 检查防火墙：`ufw status`（如果启用了）
- 查看Nginx错误日志：`tail -20 /var/log/nginx/hello-world-error.log`

### 问题3：显示Nginx默认页面

**症状**：访问显示"Welcome to Nginx"而不是Hello World

**解决方案**：
```bash
# 检查文件是否存在
ls -la /var/www/hello-world/

# 如果没有index.html，手动上传
# 然后重启Nginx
systemctl restart nginx
```

### 问题4：权限被拒绝

**症状**：部署脚本执行失败，提示权限错误

**解决方案**：
```bash
# 使用sudo或root权限执行
sudo bash deploy.sh

# 或切换到root用户
sudo su -
bash deploy.sh
```

---

## 🔐 安全建议

部署完成后，建议进行以下安全加固：

### 1. 修改SSH端口（可选）

```bash
# 编辑SSH配置
nano /etc/ssh/sshd_config

# 找到 #Port 22，改为：
Port 2222

# 重启SSH服务
systemctl restart sshd
```

记得在安全组中开放新端口并关闭22端口！

### 2. 禁用Root密码登录（推荐）

```bash
# 先创建普通用户
adduser yourname

# 将用户加入sudo组
usermod -aG sudo yourname

# 配置密钥登录后，再禁用root密码登录
```

### 3. 配置防火墙

```bash
# 安装UFW防火墙
apt install ufw -y

# 允许SSH和HTTP
ufw allow 22/tcp
ufw allow 80/tcp

# 启用防火墙
ufw enable
```

### 4. 定期更新系统

```bash
# Ubuntu/Debian
apt update && apt upgrade -y

# CentOS
yum update -y
```

---

## 🚀 后续扩展

### 启用HTTPS（需要域名）

如果您有域名，可以使用Let's Encrypt免费SSL证书：

```bash
# 安装Certbot
apt install certbot python3-certbot-nginx -y

# 获取证书（替换your-domain.com为您的域名）
certbot --nginx -d your-domain.com

# 自动续期
certbot renew --dry-run
```

### 绑定域名

1. 在域名提供商处添加A记录：
   - 类型：A
   - 主机记录：@（或www）
   - 记录值：您的公网IP
   - TTL：默认

2. 修改Nginx配置：
   ```bash
   nano /etc/nginx/sites-available/hello-world
   # 将 server_name _; 改为 server_name your-domain.com;
   ```

3. 重新加载Nginx：
   ```bash
   systemctl reload nginx
   ```

---

## 💬 需要帮助？

如果在部署过程中遇到任何问题，请提供以下信息：

1. 错误截图或错误信息
2. 执行的命令
3. Nginx日志内容：`tail -50 /var/log/nginx/hello-world-error.log`

---

**祝您部署顺利！🎉**
